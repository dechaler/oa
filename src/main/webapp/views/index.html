<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>办公管理系统</title>
    <link rel="stylesheet" href="../layui/css/layui.css">
    <script src="../layui/layui.js"></script>
    <script src="../js/myindex.js"></script>
    <script src="../js/jquery-3.3.1.js"></script>
    <style>
        .icon{
            margin: 0px 5px 0px 0px;
        }
    </style>
</head>


<body class="layui-layout-body">
<div class="layui-layout layui-layout-admin">
    <div class="layui-header">
        <div class="layui-logo">办公管理系统</div>
        <!-- 头部区域（可配合layui已有的水平导航） -->
        <!--<ul class="layui-nav layui-layout-left" >-->
            <!--<li class="layui-nav-item"><a href="">控制台</a></li>-->
            <!--<li class="layui-nav-item" ><a href="">点击表格</a>-->

            <!--</li>-->
            <!--<li class="layui-nav-item"><a href="">用户</a></li>-->
            <!--<li class="layui-nav-item">-->
                <!--<a href="javascript:;">其它系统</a>-->
                <!--<dl class="layui-nav-child">-->
                    <!--<dd><a href="">邮件管理</a></dd>-->
                    <!--<dd><a href="">消息管理</a></dd>-->
                    <!--<dd><a href="">授权管理</a></dd>-->
                <!--</dl>-->
            <!--</li>-->
        <!--</ul>-->
        <ul class="layui-nav layui-layout-right">
            <li class="layui-nav-item">
                <a href="javascript:;">
                    <!--<img src="http://t.cn/RCzsdCq" class="layui-nav-img">-->
                    <!--<span class="layui-nav-title">欢迎您：</span>-->
                    <i class="layui-icon icon">&#xe770;</i>
                  <span id="emp"></span>
                </a>
                <dl class="layui-nav-child">
                    <dd><a href="./info.html">基本资料</a></dd>
                    <dd><a href="./cgepwd.html">修改密码</a></dd>
                </dl>
            </li>
            <li class="layui-nav-item"><a href="./login.html" id="logout">退出</a></li>
        </ul>
    </div>

    <div class="layui-side layui-bg-black">
        <div class="layui-side-scroll">
            <!-- 左侧导航区域（可配合layui已有的垂直导航） -->
            <ul class="layui-nav layui-nav-tree"  lay-filter="test">
                <li class="layui-nav-item layui-nav-itemed">

                    <a class="index" href="./index.html">
                        <i class="layui-icon icon">&#xe68e;</i>
                        主页</a>
                </li>
                <li class="layui-nav-item ">
                    <a class="" href="javascript:;">个人办公</a>
                    <dl class="layui-nav-child">
                        <dd><a href="./task.html" >
                            <i class="layui-icon icon">&#xe62a;</i>
                            计划任务管理</a></dd>
                        <dd><a href="./scheule.html">
                            <i class="layui-icon icon">&#xe637;</i>
                            日程安排</a></dd>
                        <dd><a href="table.html">
                            <i class="layui-icon icon">&#xe621;</i>
                            文件管理</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item">
                    <a href="javascript:;">考勤管理</a>
                    <dl class="layui-nav-child">
                        <dd><a href="./clockin.html">
                            <i class="layui-icon icon">&#xe60c;</i>
                            打卡</a></dd>
                        <dd><a href="./kaoqin.html">
                            <i class="layui-icon icon">&#xe60e;</i>
                            考勤情况</a></dd>
                        <dd><a href="./leave.html">
                            <i class="layui-icon icon">&#xe69c;</i>
                            请假</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item">
                    <a href="javascript:;">人事管理</a>
                    <dl class="layui-nav-child">
                        <dd><a href="./employee.html">
                            <i class="layui-icon icon">&#xe612;</i>
                            员工信息</a></dd>
                        <dd><a href="./department.html">
                            <i class="layui-icon icon">&#xe613;</i>
                            部门信息</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item"><a href="javascript:;">个人中心</a>
                    <dl class="layui-nav-child">
                        <dd><a href="./info.html">
                            <i class="layui-icon icon">&#xe770;</i>
                            基本资料</a></dd>
                        <dd><a href="cgepwd.html">
                            <i class="layui-icon icon">&#xe614;</i>
                            修改密码</a></dd>
                    </dl>
                </li>
            </ul>
        </div>
    </div>

    <div class="layui-body" >
         <!--内容主体区域-->

        <iframe id="iframeMain" src="" style="width: 100%"; height="100%";></iframe>
        <!--<div style="padding: 15px;">-->
        <!--</div>-->
    </div>

    <div class="layui-footer">
        <!-- 底部固定区域 -->
        layui.com - 底部固定区域
    </div>
</div>
<!--设置登陆失败的遮挡页-->
<div id="black_box" class="black-box"
     style="z-index:1000;background-color:#fff;display: block;position:fixed;top:0px;bottom:0px;left: 0px;right: 0px;width: 100%;height: 100%;"></div>


<script>
    //jquery
    // $(function(){
    //     $.ajax({
    //                 url: "../RequiredSession",
    //                 type: "POST",
    //                 dataType: "json",
    //                 async: false,
    //                 success:function (res) {
    //                     if (res.code == 0){
    //                         console.log(res);
    //                         $("#black_box").hide();
    //                         $("#emp").html(res.data.employee.name);
    //                     }else {
    //                         alert("请先登录");
    //                         location.href = "login.html";
    //                     }
    //                 }
    //             })
    // })

    //layui 组件
    layui.use(['layer', 'form'], function() {
        var $ = layui.$;

        //请求主页判断session
        $.ajax({
            url: "../RequiredSession",
            type: "POST",
            dataType: "json",
            async: false,
            success: function (res) {
                if (res.code == 0) {
                    console.log(res);
                    console.log(res.data[0].name);
                    $("#black_box").hide();
                    $("#emp").html(res.data[0].name);
                } else {
                    // alert("请先登录");
                    location.href = "login.html";
                }
            },
            error: function () {
                alert("访问异常");
                location.href = "login.html";
            }
        });


        //退出
        $("#logout").click(function () {
            confirm("确定退出吗？");
            $.ajax({
                url: "../emp/logout",
                type: "POST",
                success: function (res) {
                    if (res == 1) {
                        alert("成功退出");
                    }
                }
            })
        })


    })
    // layui.config({
    //     base: '../js/' //你存放新模块的目录，注意，不是layui的模块目录
    // }).use('index'); //加载入口


    //模拟单页跳转
    $(document).ready(function(){
       $("dd>a, .index").click(function (e) {
            e.preventDefault();
            $("#iframeMain").attr("src",$(this).attr("href"));
        });
    });


</script>


</body>
</html>
